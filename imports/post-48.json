{
    "comments": [],
    "tags": ["php", "web-dev"],
    "title": "pathConcat",
    "html": "<p>I developed the following php function after writing\n<span class=\"geshifilter\"><code class=\"text geshifilter-text\">trim($path,'/')</code></span> too many\ntimes. It took me a lot of iterations to pass all the unit tests,\nbut it works with URI and file paths for all OSs. It goes as far as\nto account for the strange possibility of a path containing an\nescaped slash. It runs pretty quickly--less than twice as long as a\nsimple use of join: <span class=\"geshifilter\"><code class=\"text geshifilter-text\">join('/',$parts)</code></span>.</p>\n<p>Much of the time, simply joining with a slash is\nacceptable--file systems and web servers treat consecutive slashes\nas one. When comparing two paths for equality, spurious slashes are\na problem. Or when running rewrite rules, an extra slash may throw\nthe application into an entirely different path.</p>\n<div class=\"php\" style=\"text-align: left\"><span style=\"color: #000000; font-weight: bold;\">function</span>\npathConcat<span style=\"color: #66cc66;\">(</span><span style=\"color: #66cc66;\">)</span> <span style=\"color: #66cc66;\">{</span><br/>\n  <span style=\"color: #0000ff;\">$parts</span> = <a href=\"http://www.php.net/func_get_args\"><span style=\"color: #000066;\">func_get_args</span></a><span style=\"color: #66cc66;\">(</span><span style=\"color: #66cc66;\">)</span>;<br/>\n  <span style=\"color: #0000ff;\">$base</span> = <a href=\"http://www.php.net/array_shift\"><span style=\"color: #000066;\">array_shift</span></a><span style=\"color: #66cc66;\">(</span><span style=\"color: #0000ff;\">$parts</span><span style=\"color: #66cc66;\">)</span>;<br/>\n  <span style=\"color: #0000ff;\">$base</span> = <a href=\"http://www.php.net/str_replace\"><span style=\"color: #000066;\">str_replace</span></a><span style=\"color: #66cc66;\">(</span><span style=\"color: #ff0000;\">'<span style=\"color: #000099; font-weight: bold;\">\\/</span>'</span>,<span style=\"color: #ff0000;\">\"<span style=\"color: #000099; font-weight: bold;\">\\x</span>01\"</span>,<span style=\"color: #0000ff;\">$base</span><span style=\"color: #66cc66;\">)</span>;<br/>\n\n  <span style=\"color: #0000ff;\">$base</span> = <a href=\"http://www.php.net/rtrim\"><span style=\"color: #000066;\">rtrim</span></a><span style=\"color: #66cc66;\">(</span><span style=\"color: #0000ff;\">$base</span>, <span style=\"color: #ff0000;\">'/'</span><span style=\"color: #66cc66;\">)</span>;<br/>\n  <span style=\"color: #0000ff;\">$paths</span> = <a href=\"http://www.php.net/array\"><span style=\"color: #000066;\">array</span></a><span style=\"color: #66cc66;\">(</span><span style=\"color: #66cc66;\">)</span>;<br/>\n  <span style=\"color: #b1b100;\">foreach</span> <span style=\"color: #66cc66;\">(</span><span style=\"color: #0000ff;\">$parts</span> <span style=\"color: #b1b100;\">as</span> <span style=\"color: #0000ff;\">$part</span><span style=\"color: #66cc66;\">)</span> <span style=\"color: #66cc66;\">{</span><br/>\n    <span style=\"color: #0000ff;\">$part</span> = <a href=\"http://www.php.net/str_replace\"><span style=\"color: #000066;\">str_replace</span></a><span style=\"color: #66cc66;\">(</span><span style=\"color: #ff0000;\">'<span style=\"color: #000099; font-weight: bold;\">\\/</span>'</span>,<span style=\"color: #ff0000;\">\"<span style=\"color: #000099; font-weight: bold;\">\\x</span>01\"</span>,<span style=\"color: #0000ff;\">$part</span><span style=\"color: #66cc66;\">)</span>;<br/>\n\n    <span style=\"color: #0000ff;\">$part</span> = <a href=\"http://www.php.net/trim\"><span style=\"color: #000066;\">trim</span></a><span style=\"color: #66cc66;\">(</span><span style=\"color: #0000ff;\">$part</span>, <span style=\"color: #ff0000;\">'/'</span><span style=\"color: #66cc66;\">)</span>;<br/>\n    <span style=\"color: #b1b100;\">if</span> <span style=\"color: #66cc66;\">(</span><a href=\"http://www.php.net/strlen\"><span style=\"color: #000066;\">strlen</span></a><span style=\"color: #66cc66;\">(</span><span style=\"color: #0000ff;\">$part</span><span style=\"color: #66cc66;\">)</span><span style=\"color: #66cc66;\">)</span>\n<span style=\"color: #66cc66;\">{</span><br/>\n      <span style=\"color: #0000ff;\">$paths</span><span style=\"color: #66cc66;\">[</span><span style=\"color: #66cc66;\">]</span> =\n<span style=\"color: #0000ff;\">$part</span>;<br/>\n    <span style=\"color: #66cc66;\">}</span><br/>\n  <span style=\"color: #66cc66;\">}</span><br/>\n  <span style=\"color: #0000ff;\">$fullpath</span> = <a href=\"http://www.php.net/join\"><span style=\"color: #000066;\">join</span></a><span style=\"color: #66cc66;\">(</span><span style=\"color: #0000ff;\">$paths</span>, <span style=\"color: #ff0000;\">'/'</span><span style=\"color: #66cc66;\">)</span>;<br/>\n  <span style=\"color: #0000ff;\">$fullpath</span> =\n<span style=\"color: #0000ff;\">$base</span> . <span style=\"color: #ff0000;\">'/'</span> . <span style=\"color: #0000ff;\">$fullpath</span>; <br/>\n  <span style=\"color: #0000ff;\">$fullpath</span> = <a href=\"http://www.php.net/str_replace\"><span style=\"color: #000066;\">str_replace</span></a><span style=\"color: #66cc66;\">(</span><span style=\"color: #ff0000;\">\"<span style=\"color: #000099; font-weight: bold;\">\\x</span>01\"</span>,<span style=\"color: #ff0000;\">'<span style=\"color: #000099; font-weight: bold;\">\\/</span>'</span>,<span style=\"color: #0000ff;\">$fullpath</span><span style=\"color: #66cc66;\">)</span>;<br/>\n\n  <span style=\"color: #b1b100;\">return</span> <span style=\"color: #0000ff;\">$fullpath</span>;<br/>\n<span style=\"color: #66cc66;\">}</span></div>\n<p>Examples:</p>\n<div class=\"php\" style=\"text-align: left\">pathConcat<span style=\"color: #66cc66;\">(</span><span style=\"color: #ff0000;\">'one'</span>,<span style=\"color: #ff0000;\">'two'</span>,<span style=\"color: #ff0000;\">'three/'</span><span style=\"color: #66cc66;\">)</span>; <span style=\"color: #808080; font-style: italic;\">// 'one/two/three'</span><br/>\npathConcat<span style=\"color: #66cc66;\">(</span><span style=\"color: #ff0000;\">'one'</span>,<span style=\"color: #ff0000;\">''</span>,<span style=\"color: #ff0000;\">'two'</span>,<span style=\"color: #ff0000;\">'/'</span>,<span style=\"color: #ff0000;\">'three/'</span><span style=\"color: #66cc66;\">)</span>; <span style=\"color: #808080; font-style: italic;\">// 'one/two/three'</span><br/>\npathConcat<span style=\"color: #66cc66;\">(</span><span style=\"color: #ff0000;\">'http://one/'</span>,<span style=\"color: #ff0000;\">'/two/'</span>,<span style=\"color: #ff0000;\">'//three/'</span><span style=\"color: #66cc66;\">)</span>; <span style=\"color: #808080; font-style: italic;\">//\n'http://one/two/three'</span><br/>\npathConcat<span style=\"color: #66cc66;\">(</span><span style=\"color: #ff0000;\">'/one'</span>,<span style=\"color: #ff0000;\">'/two/'</span>,<span style=\"color: #ff0000;\">'//three.php'</span><span style=\"color: #66cc66;\">)</span>; <span style=\"color: #808080; font-style: italic;\">//\n'/one/two/three.php'</span><br/>\npathConcat<span style=\"color: #66cc66;\">(</span><span style=\"color: #ff0000;\">'c:/one/two/'</span>,<span style=\"color: #ff0000;\">'/../three/'</span><span style=\"color: #66cc66;\">)</span>; <span style=\"color: #808080; font-style: italic;\">//\n'c:/one/two/../three'</span><br/>\npathConcat<span style=\"color: #66cc66;\">(</span><span style=\"color: #ff0000;\">\"bats<span style=\"color: #000099; font-weight: bold;\">\\\\</span>/\"</span>,<span style=\"color: #ff0000;\">\"like\"</span>,<span style=\"color: #ff0000;\">\"thedark\"</span><span style=\"color: #66cc66;\">)</span>;\n<span style=\"color: #808080; font-style: italic;\">//\n\"bats\\\\//like/thedark\"</span><br/>\npathConcat<span style=\"color: #66cc66;\">(</span><span style=\"color: #ff0000;\">\"bats<span style=\"color: #000099; font-weight: bold;\">\\\\</span>//like\"</span>,<span style=\"color: #ff0000;\">\"caves\"</span><span style=\"color: #66cc66;\">)</span>;\n<span style=\"color: #808080; font-style: italic;\">//\n\"bats\\\\//like/caves\"</span></div>",
    "timestamp": 1256104800000,
    "slug": "pathconcat",
    "nid": 48
}